// Fol Login
DELIMITER //
CREATE PROCEDURE `loginWithUsername`(IN `iUsername` VARCHAR(150), IN `iPassword` VARCHAR(150))
BEGIN
SELECT U.*
FROM `SCP_UserLogin` AS U, SCP_Status AS S
WHERE U.UserName=iUsername AND U.Password= iPassword AND S.StatusID=U.StatusID ;
END//
DELIMITER ;

// For Create an client enquiry
DELIMITER //
CREATE PROCEDURE `createEnquiry`(IN `iOrgID` varchar(150),IN `iCustomerTitle` varchar(150),IN `iCustomerName` varchar(150),IN `iCustomerSurname` varchar(150),IN `iCustomerMiddleName` varchar(150),IN `iDateOfBirth` varchar(40),IN `iNHSNumber` varchar(150),IN `iGender` varchar(40),IN `iEthnicity` varchar(150),IN `iAddress1` varchar(150),IN `iAddress2` varchar(150),IN `iPostCode` varchar(9),IN `iCity` varchar(150),IN `iLandline` varchar(150),IN `iContactNo` varchar(150),IN `iOtherDetails` varchar(150),IN `iCareInfo` varchar(150),IN `iOutcomesInfo` varchar(150),IN `iSupportInfo` varchar(150),IN `iMakeEnq` varchar(150),IN `iRightsID` int(11), IN `iAccessLevelID` int(11),IN `iUserTypeID` int(11),`iCreatedDateTime` datetime,`iModifyDateTime` datetime,`iStatusID` int(11))
BEGIN
DECLARE UID int;
insert into SCP_UserLogin (StatusID,CreatedDateTime,ModifyDateTime) values (iStatusID,iCreatedDateTime,iModifyDateTime);
SET UID = LAST_INSERT_ID();
insert into SCP_UserAccess (RightsID,AccessLevelID,UserID,UserTypeID,CreatedDateTime,ModifyDateTime,StatusID) values (iRightsID,iAccessLevelID,UID,iUserTypeID,iCreatedDateTime,iModifyDateTime,iStatusID);

insert into SCP_Customer (CustomerTitle,CustomerName,CustomerSurname,CustomerMiddleName,DateOfBirth,NHSNumber,Gender,Ethnicity,Address1,Address2,PostCode,City,Landline,ContactNo,OtherDetails,CareInfo,OutcomesInfo,SupportInfo,MakeEnq,UserID,StatusID,CreatedDateTime,ModifyDateTime) values (iCustomerTitle,iCustomerName,iCustomerSurname,iCustomerMiddleName,iDateOfBirth,iNHSNumber,iGender,iEthnicity,iAddress1,iAddress2,iPostCode,iCity,iLandline,iContactNo,iOtherDetails,iCareInfo,iOutcomesInfo,iSupportInfo,iMakeEnq,UID,iStatusID,iCreatedDateTime,iModifyDateTime);
SET UID = LAST_INSERT_ID();
insert into SCP_Enquiry (OrgID,CustomerID,StatusID,CreatedDateTime,ModifyDateTime) values (iOrgID,UID,iStatusID,iCreatedDateTime,iModifyDateTime);
END//
DELIMITER ;

// For Load all forms of organisaers
DELIMITER //
CREATE PROCEDURE `loadAllOrgniserForms`(IN `iOrgID` INT(11))
BEGIN
SELECT *
FROM `SCP_FormBuilder`
WHERE SCP_FormBuilder.StatusID=1;
END//
DELIMITER ;

// For Load all countries
DELIMITER //
CREATE PROCEDURE `loadAllCountry`()
BEGIN
SELECT *
FROM `SCP_Country`;
END//
DELIMITER ;


// For Create staff
DELIMITER //
CREATE PROCEDURE `createStaff`(IN `iOrgID` int(11),IN `iTitle` varchar(150),IN `iName` varchar(150),IN `iSurname` varchar(150),IN `iMiddleName` varchar(150),IN `iDateOfBirth` varchar(40),IN `iGender` varchar(40),IN `iEthnicity` varchar(40),IN `iHouseNumber` varchar(150),IN `iAddress1` varchar(150),IN `iAddress2` varchar(150),IN `iCity` varchar(9),IN `iCountry` varchar(150),IN `iPostCode` varchar(9),IN `iMobile` varchar(150),IN `iProfilePhoto` varchar(256),IN `iNOKName` varchar(150),IN `iNOKMobile` varchar(150),IN `iNOKEmail` varchar(150),IN `iUserName` varchar(150),IN `iPassword` varchar(150),IN `iRightsID` int(11), IN `iAccessLevelID` int(11),IN `iUserTypeID` int(11),`iCreatedDateTime` datetime(3),`iModifyDateTime` datetime(3),`iStatusID` int(11),`iLicenseID` int(11))
BEGIN
DECLARE UID int;
DECLARE UserAccessID int;

insert into SCP_UserLogin (UserName,Password,ProfilePhoto,StatusID,CreatedDateTime,ModifyDateTime) values (iUserName,iPassword,iProfilePhoto,iStatusID,iCreatedDateTime,iModifyDateTime);
SET UID = LAST_INSERT_ID();
insert into SCP_UserAccess (RightsID,AccessLevelID,UserID,UserTypeID,CreatedDateTime,ModifyDateTime,StatusID) values (iRightsID,iAccessLevelID,UID,iUserTypeID,iCreatedDateTime,iModifyDateTime,iStatusID);
SET UserAccessID = LAST_INSERT_ID();

insert into SCP_Staff (Title,Name,Surname,MiddleName,DateOfBirth,Gender,Ethnicity,HouseNumber,Address1,Address2,City,Country,PostCode,Mobile,	ProfilePhoto,NOKName,NOKMobile,NOKEmail,OrgID,UserAccessID,LicenseID,UserID,StatusID,CreatedDateTime,ModifyDateTime) values (iTitle,iName,iSurname,iMiddleName,iDateOfBirth,iGender,iEthnicity,iHouseNumber,iAddress1,iAddress2,iCity,iCountry,iPostCode,iMobile,	iProfilePhoto,iNOKName,iNOKMobile,iNOKEmail,iOrgID,UserAccessID,iLicenseID,UID,iStatusID,iCreatedDateTime,iModifyDateTime);

update SCP_Licenses SET OrgID=iOrgID,UserID=UID where LicenseID=iLicenseID;

END//
DELIMITER ;


